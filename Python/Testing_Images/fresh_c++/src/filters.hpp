
#ifndef FILTER_H
#define FILTER_H

#include "master.h"

#define SPLN4   0
#define BIOR4_4 1
#define RBIO2_8 2
#define HAAR    3

/* scaling functions phi for spln4 and bior4.4 wavelet decomposition */
#define SPLN4_L1   {0.088388347648318f, 0.353553390593274f, 0.530330085889911f, \
                    0.353553390593274f, 0.088388347648318f}
#define SPLN4_L2   {0.015625000000000f, 0.062500000000000f, 0.156250000000000f, \
                    0.312500000000000f, 0.484375000000000f, 0.625000000000000f, \
                    0.687500000000000f, 0.625000000000000f, 0.484375000000000f, \
                    0.312500000000000f, 0.156250000000000f, 0.062500000000000f, \
                    0.015625000000000f}
#define SPLN4_L3   {0.001953125000000f, 0.007812500000000f, 0.019531250000000f, \
                    0.039062500000000f, 0.068359375000000f, 0.109375000000000f, \
                    0.164062500000000f, 0.234375000000000f, 0.314453125000000f, \
                    0.398437500000000f, 0.480468750000000f, 0.554687500000000f, \
                    0.615234375000000f, 0.656250000000000f, 0.671875000000000f, \
                    0.656250000000000f, 0.615234375000000f, 0.554687500000000f, \
                    0.480468750000000f, 0.398437500000000f, 0.314453125000000f, \
                    0.234375000000000f, 0.164062500000000f, 0.109375000000000f, \
                    0.068359375000000f, 0.039062500000000f, 0.019531250000000f, \
                    0.007812500000000f, 0.001953125000000f}

#define BIOR4_4_L1 {0.037828455507264f, -0.023849465019557f, -0.110624404418437f, \
                    0.377402855612831f, 0.852698679008894f, 0.377402855612831f, \
                    -0.110624404418437f, -0.023849465019557f, 0.037828455507264f }
#define BIOR4_4_L2 {0.002861984092130f, -0.001804376852729f, -0.010173877573850f, \
                    0.029690728227167f, 0.061419713085834f, 0.015828087584264f, \
                    0.003986336613986f, -0.121307733921579f, -0.199507301384382f, \
                    0.161830677922413f, 0.506187540959864f, 0.915762617040464f, \
                    1.270451208412836f, 0.915762617040464f, 0.506187540959864f, \
                    0.161830677922413f, -0.199507301384382f, -0.121307733921579f, \
                    0.003986336613986f, 0.015828087584264f, 0.061419713085834f, \
                    0.029690728227167f, -0.010173877573850f, -0.001804376852729f, \
                    0.002861984092130f}
#define BIOR4_4_L3 {0.000153109036389f, -0.000096529677423f, -0.000544277166304f, \
                    0.001588380173409f, 0.003189272333749f, 0.000907621800064f, \
                    0.000556406054952f, -0.007491078208457f, -0.013192470934218f, \
                    0.008405974106254f, 0.028536991243774f, 0.048437508669259f, \
                    0.066613632424065f, 0.040093464434385f, 0.003953227902331f, \
                    0.012595435045625f, 0.013921697671443f, -0.056422566499899f, \
                    -0.106191878625464f, -0.176820758706383f, -0.219632102522184f, \
                    -0.033090395116600f, 0.189673598393652f, 0.332382157214459f, \
                    0.499117664226386f, 0.710626608019442f, 0.884015932197060f, \
                    1.118884178745867f, 1.299658395528740f, 1.118884178745867f, \
                    0.884015932197060f, 0.710626608019442f, 0.499117664226387f, \
                    0.332382157214459f, 0.189673598393652f, -0.033090395116600f, \
                    -0.219632102522184f, -0.176820758706383f, -0.106191878625464f, \
                    -0.056422566499899f, 0.013921697671443f, 0.012595435045625f, \
                    0.003953227902331f, 0.040093464434385f, 0.066613632424065f, \
                    0.048437508669259f, 0.028536991243774f, 0.008405974106254f, \
                    -0.013192470934218f, -0.007491078208457f, 0.000556406054952f, \
                    0.000907621800064f, 0.003189272333749f, 0.001588380173409f, \
                    -0.000544277166304f, -0.000096529677423f, 0.000153109036389f}

/* decomposition and reconstruction low- and high-pass filters for spln4 wavelet */
#define SPLN4_LO_D {0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.088388347648318f, 0.353553390593274f, 0.530330085889911f, \
                    0.353553390593274f, 0.088388347648318f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.000000000000000f}
#define SPLN4_HI_D {-0.006042172202522f, -0.024168688810087f, 0.009494842032534f, \
                    0.158822812180572f, 0.096156854765846f, -0.506161397079824f, \
                    -0.453162915189133f, 1.450121328605225f, -0.453162915189133f, \
                    -0.506161397079824f, 0.096156854765846f, 0.158822812180572f, \
                    0.009494842032534f, -0.024168688810087f, -0.006042172202522f, \
                    0.000000000000000f}
#define SPLN4_LO_R {0.006042172202522f, -0.024168688810087f, -0.009494842032534f, \
                    0.158822812180572f, -0.096156854765846f, -0.506161397079824f, \
                    0.453162915189133f, 1.450121328605225f, 0.453162915189133f, \
                    -0.506161397079824f, -0.096156854765846f, 0.158822812180572f, \
                    -0.009494842032534f, -0.024168688810087f, 0.006042172202522f, \
                    0.000000000000000f}
#define SPLN4_HI_R {0.000000000000000f, -0.000000000000000f, 0.000000000000000f, \
                    -0.000000000000000f, 0.000000000000000f, -0.000000000000000f, \
                    0.088388347648318f, -0.353553390593274f, 0.530330085889911f, \
                    -0.353553390593274f, 0.088388347648318f, -0.000000000000000f, \
                    0.000000000000000f, -0.000000000000000f, 0.000000000000000f, \
                    -0.000000000000000f}

/* decomposition and reconstruction low- and high-pass filters for bior4.4 wavelet */
#define BIOR4_4_LO_D {0.000000000000000f, 0.037828455507264f, -0.023849465019557f, \
                    -0.110624404418437f, 0.377402855612831f, 0.852698679008894f, \
                    0.377402855612831f, -0.110624404418437f, -0.023849465019557f, \
                    0.037828455507264f}
#define BIOR4_4_HI_D {-0.000000000000000f, -0.064538882628697f, 0.040689417609164f, \
                    0.418092273221617f, -0.788485616405583f, 0.418092273221617f, \
                    0.040689417609164f, -0.064538882628697f, -0.000000000000000f, \
                    0.000000000000000f}
#define BIOR4_4_LO_R {0.000000000000000f, -0.064538882628697f, -0.040689417609164f, \
                    0.418092273221617f, 0.788485616405583f, 0.418092273221617f, \
                    -0.040689417609164f, -0.064538882628697f, 0.000000000000000f, \
                    0.000000000000000f}
#define BIOR4_4_HI_R {0.000000000000000f, -0.037828455507264f, -0.023849465019557f, \
                    0.110624404418437f, 0.377402855612831f, -0.852698679008894f, \
                    0.377402855612831f, 0.110624404418437f, -0.023849465019557f, \
                    -0.037828455507264f}

/* decomposition and reconstruction low- and high-pass filters for rbio2.8 wavelet */
#define RBIO2_8_LO_D {0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.353553390593274f, \
                    0.707106781186548f, 0.353553390593274f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.000000000000000f, \
                    0.000000000000000f, 0.000000000000000f, 0.000000000000000f}
#define RBIO2_8_HI_D {-0.001510543050630f, -0.003021086101261f, 0.012947511862547f, \
                    0.028916109826354f, -0.052998481890691f, -0.134913073607736f, \
                    0.163829183434090f, 0.462571440475917f, -0.951642121897179f, \
                    0.462571440475917f, 0.163829183434090f, -0.134913073607736f, \
                    -0.052998481890691f, 0.028916109826354f, 0.012947511862547f, \
                    -0.003021086101261f, -0.001510543050630f, 0.000000000000000f}
#define RBIO2_8_LO_R {0.001510543050630f, -0.003021086101261f, -0.012947511862547f, \
                    0.028916109826354f, 0.052998481890691f, -0.134913073607736f, \
                    -0.163829183434090f, 0.462571440475917f, 0.951642121897179f, \
                    0.462571440475917f, -0.163829183434090f, -0.134913073607736f, \
                    0.052998481890691f, 0.028916109826354f, -0.012947511862547f, \
                    -0.003021086101261f, 0.001510543050630f, 0.000000000000000f}
#define RBIO2_8_HI_R {0.000000000000000f, -0.000000000000000f, 0.000000000000000f, \
                    -0.000000000000000f, 0.000000000000000f, -0.000000000000000f, \
                    0.000000000000000f, -0.000000000000000f, 0.353553390593274f, \
                    -0.707106781186548f, 0.353553390593274f, -0.000000000000000f, \
                    0.000000000000000f, -0.000000000000000f, 0.000000000000000f, \
                    -0.000000000000000f, 0.000000000000000f, -0.000000000000000f}

/* decomposition and reconstruction low- and high-pass filters for haar wavelet */
#define SQRT2     (real_t)std::sqrt(2)
#define INV_SQRT2 (real_t)(1/SQRT2)
#define HAAR_LO_D {INV_SQRT2, INV_SQRT2}
#define HAAR_HI_D {-INV_SQRT2, INV_SQRT2}
#define HAAR_LO_R {INV_SQRT2, INV_SQRT2}
#define HAAR_HI_R {INV_SQRT2, -INV_SQRT2}

/* map structure containing wavelet filters organized as map<int,2Dvector> 
   where int defines the wavelet name and 2Dvector contains the corresponding
   filter phi at different levels; for example, filter phi at level N of 
   wavelet W is stored in map[W][N-1]; map : int->{f : int->phi} */
#define PHI_MAP {  { SPLN4,   { SPLN4_L1,   SPLN4_L2,   SPLN4_L3   } }, \
                   { BIOR4_4, { BIOR4_4_L1, BIOR4_4_L2, BIOR4_4_L3 } }  }

/* similar map structure as before, mapping wavelet and level to the 
   corresponding shift; map : int->{f : int->loc_shift} */
#define LOC_SHIFT_MAP {  { SPLN4,   {2,  6, 14} }, \
                         { BIOR4_4, {4, 12, 28} }  }


#endif
